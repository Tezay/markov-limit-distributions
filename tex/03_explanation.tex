\section*{Explication des résultats expérimentaux}
\phantomsection
\addcontentsline{toc}{section}{Explication des résultats expérimentaux}

\subsection*{Question 8 — structure de la chaîne à 27 états}
\phantomsection
\addcontentsline{toc}{subsection}{Question 8 — structure de la chaîne à 27 états}

\tikzset{
    state/.style={circle, draw=black!60, thick, minimum size=0.6cm, font=\bfseries\footnotesize},
    lbl/.style={fill=white, inner sep=0.5pt, text=black!80, font=\tiny, fill opacity=0.85, text opacity=1},
    c1/.style={fill=red!20},      % C1: {11, 18, 4, 26, 27, 1}
    c2/.style={fill=blue!20},     % C2: {5, 12, 21, 25, 2}
    c3/.style={fill=green!20},    % C3: {6, 20, 17}
    c4/.style={fill=orange!30},   % C4: {7, 23, 3}
    c5/.style={fill=cyan!20},     % C5: {16, 9, 8}
    c6/.style={fill=magenta!20},  % C6: {14}
    c7/.style={fill=yellow!40},   % C7: {19, 22, 24, 10}
    c8/.style={fill=violet!20},   % C8: {15, 13}
    >={Stealth[round]},
    shorten >=1pt,
    auto,
    node distance=2cm,
    on grid,
    every edge/.style={draw, ->, thick}
}

\paragraph{a) Classes communicantes}
Pour cette analyse, nous avons utilisé notre programme C \texttt{markov\_analyzer} \parencite{markovGraphAnalyzer2025} avec la commande suivante :
\begin{center}
\texttt{./markov\_analyzer -{}-in data/moodle/matrix.txt -{}-period}
\end{center}
Les résultats complets sont disponibles dans le fichier \texttt{data/q8/program\_out.txt}, et les fichiers sources des graphes générés sont \texttt{data/q8/graph.mmd} (graphe complet\textsuperscript{\ref{fig:full_graph}}) et \texttt{data/q8/hasse.mmd} (diagramme de Hasse).

L'analyse de la matrice de transition a permis d'identifier 8 classes communicantes distinctes :
\begin{itemize}
    \item \textbf{C1} : \{1, 4, 11, 18, 26, 27\}
    \item \textbf{C2} : \{2, 5, 12, 21, 25\}
    \item \textbf{C3} : \{6, 17, 20\}
    \item \textbf{C4} : \{3, 7, 23\}
    \item \textbf{C5} : \{8, 9, 16\}
    \item \textbf{C6} : \{14\}
    \item \textbf{C7} : \{10, 19, 22, 24\}
    \item \textbf{C8} : \{13, 15\}
\end{itemize}

\paragraph{b) Graphe réduit (Diagramme de Hasse)\textsuperscript{\ref{lst:hasse_diagram}}}
Le graphe réduit montre les relations d'accessibilité entre les classes. Les classes finales sont C1, C2, C3 et C5.

\begin{figure}[H]
\centering
\begin{tikzpicture}[
    node distance=2cm and 2cm,
    every node/.style={
        rectangle, 
        rounded corners=5pt, 
        draw=black!60, 
        thick, 
        align=center, 
        minimum width=2.5cm,
        minimum height=1.2cm,
        drop shadow
    },
    edge from parent/.style={draw, ->, thick, black!70}
]
    % Arbre Gauche (Racine C8)
    \node[c8] (C8) at (0,0) {\textbf{C8} \\ \scriptsize \{15, 13\}};
    \node[c4] (C4) [below left=2.5cm and 2cm of C8] {\textbf{C4} \\ \scriptsize \{7, 23, 3\}};
    \node[c1] (C1) [below right=2.5cm and 2cm of C8] {\textbf{C1} \\ \scriptsize \{11, 18, 4, 26, 27, 1\}};
    \node[c3] (C3) [below=2cm of C4] {\textbf{C3} \\ \scriptsize \{6, 20, 17\}};

    % Arbre Droite (Racine C7)
    \node[c7] (C7) at (8,0) {\textbf{C7} \\ \scriptsize \{19, 22, 24, 10\}};
    \node[c6] (C6) [below=2.5cm of C7] {\textbf{C6} \\ \scriptsize \{14\}};
    \node[c5] (C5) [below left=2cm and 2cm of C6] {\textbf{C5} \\ \scriptsize \{16, 9, 8\}};
    \node[c2] (C2) [below right=2cm and 2cm of C6] {\textbf{C2} \\ \scriptsize \{5, 12, 21, 25, 2\}};

    % Liens
    \draw[->, thick] (C8) -- (C4);
    \draw[->, thick] (C8) -- (C1);
    \draw[->, thick] (C4) -- (C3);
    \draw[->, thick] (C7) -- (C6);
    \draw[->, thick] (C6) -- (C5);
    \draw[->, thick] (C6) -- (C2);
\end{tikzpicture}
\caption{Diagramme de Hasse de la chaîne de Markov.}
\label{fig:hasse}
\end{figure}

\paragraph{c) Analyse détaillée par classe (et calcule de leur période\textsuperscript{\ref{lst:compute_period}})}
\mbox{}\hfill\\

\noindent
\begin{minipage}[t]{0.48\textwidth}
    \textbf{Classe C1 (Finale, 2-périodique)} \\
    Cette classe est \textbf{persistante} (finale) car elle ne mène à aucune autre classe. Elle est périodique de période 2.
    \begin{center}
    \begin{tikzpicture}
        \node[state, c1] (A) at (0,0) {1};
        \node[state, c1] (AA) [above left=1.5cm and 1cm of A] {27};
        \node[state, c1] (K) [above right=1.5cm and 1cm of A] {11};
        \node[state, c1] (D) [below=2cm of A] {4};
        \node[state, c1] (R) [right=2cm of K] {18};
        \node[state, c1] (Z) [left=2cm of D] {26};

        \path (A) edge[bend right] node[lbl]{0.20} (AA)
              (A) edge node[lbl]{0.20} (K)
              (A) edge node[lbl]{0.60} (D);
        \path (D) edge node[lbl]{0.20} (Z)
              (D) edge[bend right=10] node[lbl]{0.20} (R)
              (D) edge[bend left] node[lbl]{0.60} (A);
        \path (K) edge node[lbl]{0.50} (R)
              (K) edge[bend left] node[lbl]{0.50} (A);
        \path (R) edge[bend left] node[lbl]{0.50} (K)
              (R) edge[bend right] node[lbl]{0.50} (D);
        \path (Z) edge[bend right] node[lbl]{0.50} (AA)
              (Z) edge[bend left] node[lbl]{0.50} (D);
        \path (AA) edge[bend right] node[lbl]{0.50} (Z)
              (AA) edge[bend right] node[lbl]{0.50} (A);
    \end{tikzpicture}
    \end{center}
\end{minipage}
\hfill
\begin{minipage}[t]{0.48\textwidth}
    \textbf{Classe C2 (Finale, Apériodique)} \\
    Classe \textbf{persistante} (finale) et aperiodique (période 1).
    \begin{center}
    \begin{tikzpicture}
        \node[state, c2] (B) at (0,0) {2};
        \node[state, c2] (L) [right=2cm of B] {12};
        \node[state, c2] (E) [below left=1.5cm and 0.8cm of L] {5};
        \node[state, c2] (U) [right=2cm of E] {21};
        \node[state, c2] (Y) [above=1.8cm of U] {25};

        \path (B) edge[bend left] node[lbl, near end]{0.10} (Y)
              (B) edge node[lbl]{0.40} (L)
              (B) edge node[lbl]{0.20} (E)
              (B) edge[loop below] node[lbl]{0.30} (B);
        \path (E) edge node[lbl]{0.30} (Y)
              (E) edge node[lbl]{0.20} (U)
              (E) edge node[lbl]{0.10} (L)
              (E) edge[bend left] node[lbl]{0.40} (B);
        \path (L) edge node[lbl]{0.20} (U)
              (L) edge[loop above] node[lbl]{0.30} (L)
              (L) edge[bend left] node[lbl]{0.40} (E)
              (L) edge[bend left] node[lbl]{0.10} (B);
        \path (U) edge node[lbl]{0.30} (Y)
              (U) edge[loop below] node[lbl]{0.10} (U)
              (U) edge[bend left] node[lbl]{0.10} (L)
              (U) edge[bend left] node[lbl]{0.30} (E)
              (U) edge[bend left=45] node[lbl]{0.20} (B);
        \path (Y) edge[loop above] node[lbl]{0.10} (Y)
              (Y) edge[bend left] node[lbl]{0.50} (U)
              (Y) edge[bend right=20] node[lbl, near start]{0.20} (L)
              (Y) edge[bend left=40] node[lbl, pos=0.2]{0.20} (B);
    \end{tikzpicture}
    \end{center}
\end{minipage}

\vspace{0.5cm}

\noindent
\begin{minipage}[t]{0.48\textwidth}
    \textbf{Classe C3 (Finale, 3-périodique)} \\
    Classe \textbf{persistante} (finale) avec une période de 3.
    \begin{center}
    \begin{tikzpicture}
        \node[state, c3] (T) at (0,0) {20};
        \node[state, c3] (F) [above=1.5cm of T] {6};
        \node[state, c3] (Q) [right=1.5cm of F] {17};

        \path (F) edge node[lbl]{1.00} (Q);
        \path (Q) edge[bend left] node[lbl]{1.00} (T);
        \path (T) edge[bend left] node[lbl]{1.00} (F);
    \end{tikzpicture}
    \end{center}
\end{minipage}
\hfill
\begin{minipage}[t]{0.48\textwidth}
    \textbf{Classe C4 (Transitoire, Apériodique)} \\
    Classe \textbf{transitoire} (mène vers C3). Période 1.
    \begin{center}
    \begin{tikzpicture}
        \node[state, c4] (C) at (0,0) {3}; 
        \node[state, c4] (G) [above right=1.5cm and 0.8cm of C] {7};
        \node[state, c4] (W) [right=2cm of C] {23};

        \path (C) edge node[lbl]{0.30} (W)
              (C) edge node[lbl]{0.30} (G);
        \path (G) edge node[lbl]{0.30} (W)
              (G) edge[bend left] node[lbl]{0.30} (C);
        \path (W) edge[bend left] node[lbl]{0.30} (G)
              (W) edge[bend left] node[lbl]{0.30} (C);
    \end{tikzpicture}
    \end{center}
\end{minipage}

\vspace{0.5cm}

\noindent
\begin{minipage}[t]{0.48\textwidth}
    \textbf{Classe C5 (Finale, Apériodique)} \\
    Classe \textbf{persistante} (finale). Période 1.
    \begin{center}
    \begin{tikzpicture}
        \node[state, c5] (P) at (0,0) {16};
        \node[state, c5] (I) [above=1.5cm of P] {9};
        \node[state, c5] (H) [right=1.5cm of I] {8};

        \path (H) edge node[lbl]{1.00} (I);
        \path (I) edge node[lbl]{0.90} (P)
              (I) edge[loop above] node[lbl]{0.10} (I);
        \path (P) edge[bend right] node[lbl, near end]{1.00} (H);
    \end{tikzpicture}
    \end{center}
\end{minipage}
\hfill
\begin{minipage}[t]{0.48\textwidth}
    \textbf{Classe C6 (Transitoire, Apériodique)} \\
    Classe \textbf{transitoire} (mène vers C5 et C2). Période 1.
    \begin{center}
    \begin{tikzpicture}
        \node[state, c6] (N) at (0,0) {14};
        \path (N) edge[loop right] node[lbl]{0.40} (N);
    \end{tikzpicture}
    \end{center}
\end{minipage}

\vspace{0.5cm}

\noindent
\begin{minipage}[t]{0.48\textwidth}
    \textbf{Classe C7 (Transitoire, Apériodique)} \\
    Classe \textbf{transitoire} (mène vers C6). Période 1.
    \begin{center}
    \begin{tikzpicture}
        \node[state, c7] (X) at (0,0) {24}; 
        \node[state, c7] (V) [right=2cm of X] {22};
        \node[state, c7] (S) [above=2cm of V] {19};
        \node[state, c7] (J) [left=2cm of S] {10};

        \path (J) edge node[lbl]{0.20} (X)
              (J) edge[bend right] node[lbl, near start]{0.20} (V)
              (J) edge node[lbl]{0.20} (S);
        \path (S) edge node[lbl]{0.30} (X)
              (S) edge node[lbl]{0.10} (V)
              (S) edge[loop right] node[lbl]{0.50} (S)
              (S) edge[bend left] node[lbl]{0.10} (J);
        \path (V) edge node[lbl]{0.20} (X)
              (V) edge[bend left] node[lbl]{0.20} (S)
              (V) edge[bend right] node[lbl]{0.20} (J);
        \path (X) edge[bend left] node[lbl]{0.30} (V)
              (X) edge[bend left] node[lbl]{0.30} (S)
              (X) edge node[lbl]{0.30} (J);
    \end{tikzpicture}
    \end{center}
\end{minipage}
\hfill
\begin{minipage}[t]{0.48\textwidth}
    \textbf{Classe C8 (Transitoire, 2-périodique)} \\
    Classe \textbf{transitoire} (mène vers C4 et C1). Période 2.
    \begin{center}
    \begin{tikzpicture}
        \node[state, c8] (M) at (0,0) {13};
        \node[state, c8] (O) [above left=1cm and 2cm of M] {15}; 
        
        \path (M) edge node[lbl]{0.70} (O);
        \path (O) edge[bend left] node[lbl]{0.50} (M);
    \end{tikzpicture}
    \end{center}
\end{minipage}

\begin{remark}
    Les graphes TikZ présentés ci-dessus ont été générés à partir des fichiers Mermaid produits par notre programme C, puis convertis en code LaTeX via l'assistant Gemini 3.
\end{remark}

\subsection*{Question 9 — interprétation des questions 1 à 7}
\phantomsection
\addcontentsline{toc}{subsection}{Question 9 — interprétation des questions 1 à 7}
Nous pouvons maintenant réinterpréter l'ensemble des résultats numériques des questions 1 à 7 grâce aux classes communicantes établies à la question 8 (Figure~\ref{fig:hasse}).
L'analyse du graphe et des classes permet d'expliquer intuitivement les comportements observés (stabilisation, oscillation ou disparition).

\begin{description}
    \item[- Questions 1, 2 et 3 : La classe finale C2] \hfill \\
    Les états $\{2, 5, 12, 21, 25\}$ forment la classe \textbf{C2}.
    D'après l'analyse de la question 8, cette classe est \textbf{finale} : une fois que le système entre dans cet ensemble d'états, il ne peut plus en sortir (aucune flèche ne quitte C2).
    De plus, elle est \textbf{apériodique} (période $d=1$), ce qui signifie qu'il n'y a pas de cycle forcé qui empêcherait la stabilisation.
    Le système finit donc par se "mélanger" complètement à l'intérieur de cette classe, ce qui conduit à une distribution d'équilibre unique.
    Cela explique pourquoi :
    \begin{itemize}
        \item À la question 1, (départ en 2) les probabilités se stabilisent vers des valeurs fixes.
        \item À la question 2, peu importe l'état de départ dans la classe, le mélange conduit au même équilibre final.
        \item À la question 3, toute répartition initiale sur ces états converge vers cette même limite.
    \end{itemize}

    \item[- Question 4 : La classe finale C5] \hfill \\
    Les états $\{8, 9, 16\}$ constituent la classe \textbf{C5}.
    Comme pour C2, cette classe est \textbf{finale} (on ne peut pas en sortir) et \textbf{apériodique}.
    Elle se comporte comme un système isolé qui possède son propre équilibre interne.
    C'est ce que nous avons observé : en partant de n'importe quel état de ce groupe, le système se stabilise vers une distribution limite propre à C5, indépendante de ce qui se passe ailleurs dans le graphe.

    \item[- Question 5 : Les classes transitoires C6 et C7] \hfill \\
    Les états $\{10, 14, 19, 22, 24\}$ appartiennent aux classes \textbf{C6} ($\{14\}$) et \textbf{C7} ($\{10, 19, 22, 24\}$).
    Ces classes sont \textbf{transitoires} : le diagramme de Hasse montre que des flèches permettent de quitter définitivement ces ensembles.
    \begin{itemize}
        \item De \textbf{C7}, on descend vers \textbf{C6}.
        \item De \textbf{C6} (état 14), le système peut "tomber" soit dans la classe finale \textbf{C2}, soit dans la classe finale \textbf{C5}.
    \end{itemize}
    Une fois parti vers C2 ou C5, le système ne revient jamais.
    Cela explique deux choses :
    \begin{enumerate}
        \item La probabilité d'être dans les états de C6 et C7 tend vers 0 (le système se vide de ces états).
        \item L'état final dépend du "chemin" pris : selon l'état de départ, on a plus ou moins de chances de finir piégé dans C2 ou dans C5. C'est pourquoi la distribution limite observée est un mélange des limites de C2 et C5, pondéré par les chances d'atterrir dans l'une ou l'autre.
    \end{enumerate}

    \item[- Question 6 : La classe finale périodique C3] \hfill \\
    Les états $\{6, 17, 20\}$ forment la classe \textbf{C3}.
    Cette classe est \textbf{finale} (on ne peut pas en sortir) mais elle possède une structure particulière : c'est un cycle pur de longueur 3 ($20 \to 6 \to 17 \to 20 \dots$).
    Le système est contraint de tourner en rond indéfiniment.
    Cela explique pourquoi nous n'avons pas observé de stabilisation vers une valeur fixe (convergence), mais une oscillation perpétuelle des probabilités avec une période de 3.
    La "moyenne" observée avec une distribution uniforme correspond à une répartition équitable de la présence sur les 3 états du cycle.

    \item[- Question 7 : La classe transitoire C4] \hfill \\
    Les états $\{3, 7, 23\}$ forment la classe \textbf{C4}.
    Le graphe montre que cette classe est \textbf{transitoire} et que toutes les issues mènent vers la classe \textbf{C3}.
    Le système est donc obligé de quitter C4 pour aller tourner dans le cycle C3.
    C'est exactement ce que montrent les résultats numériques : la probabilité d'être en 3, 7 ou 23 diminue jusqu'à 0, car toute la "matière" est transférée vers la classe C3.
\end{description}

\subsection*{Question 10 : distributions stationnaires de la classe finale non explorée}
\phantomsection
\addcontentsline{toc}{subsection}{Question 10 : distributions stationnaires de la classe finale non explorée}

\paragraph{Identification de la classe}
D'après l'analyse de la structure de la chaîne (Question 8), les classes finales (persistantes) sont $C1, C2, C3$ et $C5$. Les classes $C2$ (Q1-Q3), $C5$ (Q4) et $C3$ (Q6) ayant déjà été étudiées, la classe finale non explorée est la classe $C1$:
$$ C1 = \{1, 4, 11, 18, 26, 27\} $$
Cette classe est \textbf{irréductible} et \textbf{2-périodique} ($d=2$).

Puisque $C1$ est une unique classe irréductible, elle admet une unique distribution stationnaire, notée $\Pi_{C1}$.

\paragraph{Système d'équations linéaires}
Nous déterminons la distribution stationnaire par $\Pi_{C1} = (\pi_1, \pi_4, \pi_{11}, \pi_{18}, \pi_{26}, \pi_{27})$ en résolvant le système $\Pi_{C1} M_{C1} = \Pi_{C1}$ et la condition de normalisation $\sum_{i \in C1} \pi_i = 1$.

En extrayant les transitions de la classe $C1$, la sous-matrice de transition $M_{C1}$ est :
$$ M_{C1} = 
\begin{pmatrix}
 & 1 & 4 & 11 & 18 & 26 & 27 \\
1 & 0 & 0 & 0 & 0.20 & 0.20 & 0.60 \\
4 & 0 & 0 & 0.50 & 0 & 0 & 0.50 \\
11 & 0 & 0.50 & 0 & 0.50 & 0 & 0 \\
18 & 0 & 0 & 0.50 & 0 & 0 & 0.50 \\
26 & 0.50 & 0.50 & 0 & 0 & 0 & 0 \\
27 & 0.50 & 0 & 0 & 0 & 0.50 & 0 \\
\end{pmatrix}
$$

En utilisant les probabilités de transition de la matrice, le système est :
\begin{align*}
\pi_1 &= 0.50 \pi_{26} + 0.50 \pi_{27} & (1) \\
\pi_4 &= 0.50 \pi_{11} + 0.50 \pi_{26} & (2) \\
\pi_{11} &= 0.50 \pi_4 + 0.50 \pi_{18} & (3) \\
\pi_{18} &= 0.20 \pi_1 + 0.50 \pi_{11} & (4) \\
\pi_{26} &= 0.20 \pi_1 + 0.50 \pi_{27} & (5) \\
\pi_{27} &= 0.60 \pi_1 + 0.50 \pi_4 + 0.50 \pi_{18} & (6) \\
\pi_1 + \pi_4 + \pi_{11} + \pi_{18} + \pi_{26} + \pi_{27} &= 1 & (7)
\end{align*}

\paragraph{Calcul et simplification en Annexes \parencite{markovGraphAnalyzer2025}}

\paragraph{Résultat de la distribution stationnaire $\Pi_{C1}$}

En substituant $\pi_1 = \frac{5}{24}$ dans les expressions trouvées :
\begin{align*}
\pi_1 &= \frac{5}{24} \\
\pi_4 &= 0.7 \cdot \frac{5}{24} = \frac{7}{10} \cdot \frac{5}{24} = \frac{7}{48} \\
\pi_{11} &= 0.6 \cdot \frac{5}{24} = \frac{3}{5} \cdot \frac{5}{24} = \frac{3}{24} = \frac{1}{8} \\
\pi_{18} &= 0.5 \cdot \frac{5}{24} = \frac{1}{2} \cdot \frac{5}{24} = \frac{5}{48} \\
\pi_{26} &= 0.8 \cdot \frac{5}{24} = \frac{4}{5} \cdot \frac{5}{24} = \frac{4}{24} = \frac{1}{6} \\
\pi_{27} &= 1.2 \cdot \frac{5}{24} = \frac{6}{5} \cdot \frac{5}{24} = \frac{6}{24} = \frac{1}{4}
\end{align*}

La distribution stationnaire unique est :
$$
\Pi_{C1} = \left( \frac{5}{24}, \frac{7}{48}, \frac{1}{8}, \frac{5}{48}, \frac{1}{6}, \frac{1}{4} \right)
$$


\begin{remark}
    La distribution stationnaire $\Pi_{C1}$ indique la répartition à long terme des probabilités entre les états de la classe finale $C1$.
    Étant donné que cette classe est 2-périodique, le système oscillera entre deux sous-ensembles d'états à chaque pas de temps.
    Cependant, la distribution stationnaire reste valide pour décrire la proportion de temps passé dans chaque état sur une longue période.
\end{remark}